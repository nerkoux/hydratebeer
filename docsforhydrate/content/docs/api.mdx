---
title: API Reference
description: Complete API documentation for üç∫ HydrateBeer
---

# API Reference

Complete reference for all üç∫ HydrateBeer functions, hooks, and types.

## CLI Commands

### init

Initialize HydrateBeer in your project.

```bash
npx hydrate-beer init
```

**What it does:**
- Generates unique `projectId`
- Sets up password for dashboard
- Prompts for Tinybird API token
- Creates `hydrate-beer.config.ts` and `.env.local`
- Auto-installs `hydrate-beer-sdk`

### setup-tinybird

Deploy Tinybird datasources and pipes to your account.

```bash
npx hydrate-beer setup-tinybird
```

**What it creates:**
- `events` datasource (MergeTree engine)
- `overview` pipe (aggregated stats)
- `realtime_metrics` pipe (recent events)

### monitor

Open password-protected monitoring dashboard.

```bash
npx hydrate-beer monitor
```

**Features:**
- Password authentication (from config)
- 5-minute session timeout
- Auto-refresh every 5 seconds
- Runs on `http://localhost:3500`

## React Provider

### HydrateBeerProvider

Root provider component that initializes tracking.

```typescript
function HydrateBeerProvider(props: {
  config: HydrateBeerConfig;
  children: React.ReactNode;
}): JSX.Element
```

**Props:**

| Prop | Type | Required | Description |
|------|------|----------|-------------|
| `config` | `HydrateBeerConfig` | Yes | Configuration object |
| `children` | `React.ReactNode` | Yes | Your app components |

**Example:**

```typescript
import { HydrateBeerProvider } from "hydrate-beer-sdk/react";

<HydrateBeerProvider
  config={{
    projectId: process.env.NEXT_PUBLIC_HYDRATE_BEER_PROJECT_ID!,
    sampleRate: 1.0,
  }}
>
  {children}
</HydrateBeerProvider>
```

## React Hooks

### useHydrateBeer()

Access tracking functions from any component.

```typescript
function useHydrateBeer(): {
  trackCustomEvent: (name: string, metadata?: Record<string, any>) => void;
  trackError: (error: Error, metadata?: Record<string, any>) => void;
  sessionId: string;
}
```

**Returns:**

| Property | Type | Description |
|----------|------|-------------|
| `trackCustomEvent` | Function | Track custom events |
| `trackError` | Function | Track errors |
| `sessionId` | string | Current session ID |

**Example:**

```typescript
'use client';

import { useHydrateBeer } from "hydrate-beer-sdk/react";

export default function MyComponent() {
  const { trackCustomEvent, trackError } = useHydrateBeer();

  const handleClick = () => {
    trackCustomEvent("button_clicked", {
      buttonId: "submit",
      timestamp: Date.now(),
    });
  };

  return <button onClick={handleClick}>Click Me</button>;
}
```

## HOC (Higher-Order Component)

### withHydrateBeer()

Wrap components to automatically track render performance.

```typescript
function withHydrateBeer<P extends object>(
  Component: React.ComponentType<P>,
  componentName?: string
): React.ComponentType<P>
```

**Parameters:**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `Component` | `React.ComponentType<P>` | Yes | Component to profile |
| `componentName` | `string` | No | Display name (defaults to Component.name) |

**Returns:** Wrapped component that tracks render duration

**Example:**

```typescript
import { withHydrateBeer } from 'hydrate-beer-sdk';

function MyComponent() {
  return <div>Hello World</div>;
}

export default withHydrateBeer(MyComponent, 'MyComponent');
```

## TypeScript Types

### HydrateBeerConfig

Configuration object for the provider.

```typescript
function wrapHydrateRoot(hydrateRoot: Function): Function
```

**Parameters:**

- `hydrateRoot` - React's hydrateRoot function

**Returns:** Wrapped hydrateRoot

**Example:**

```typescript
import { hydrateRoot } from 'react-dom/client';
import { wrapHydrateRoot } from 'hydrate-beer';

const wrappedHydrateRoot = wrapHydrateRoot(hydrateRoot);
wrappedHydrateRoot(document.getElementById('root')!, <App />);
```

### trackNextRouter()

Track Next.js router navigation events.

```typescript
function trackNextRouter(router: NextRouter): void
```

**Parameters:**

- `router` - Next.js router instance from `useRouter()`

**Example:**

```typescript
import { useRouter } from 'next/router';
import { trackNextRouter } from 'hydrate-beer';

function MyApp({ Component, pageProps }) {
  const router = useRouter();
  
  useEffect(() => {
    trackNextRouter(router);
  }, [router]);
  
  return <Component {...pageProps} />;
}
```

### destroyHydrateBeer()

Cleanup and flush remaining metrics. Automatically called on page unload.

```typescript
function destroyHydrateBeer(): void
```

**Example:**

```typescript
// Usually not needed - handled automatically
// But you can call manually if needed
destroyHydrateBeer();
```

## Type Definitions

### HydrateBeerConfig

Configuration object for SDK initialization.

```typescript
interface HydrateBeerConfig {
  projectKey: string;           // Required: Your project key
  sampleRate?: number;          // Default: 1.0 (100%)
  endpoint?: string;            // Default: Tinybird endpoint
  flushInterval?: number;       // Default: 5000ms
  batchSize?: number;           // Default: 50 events
  slowRenderThreshold?: number; // Default: 16ms
}
```

### MetricEvent

Internal event structure (for reference).

```typescript
interface MetricEvent {
  timestamp: number;
  sessionId: string;
  projectKey: string;
  eventType: 'hydration' | 'render' | 'navigation' | 'page_timing';
  route: string;
  componentName?: string;
  duration: number;
  metadata?: Record<string, any>;
}
```

### HydrationMetric

Hydration timing data.

```typescript
interface HydrationMetric {
  startTime: number;
  endTime: number;
  duration: number;
  route: string;
}
```

### RenderMetric

Component render data.

```typescript
interface RenderMetric {
  componentName: string;
  duration: number;
  phase: 'mount' | 'update';
  renderCount: number;
  isSlow: boolean;
}
```

### NavigationMetric

Route transition data.

```typescript
interface NavigationMetric {
  from: string;
  to: string;
  duration: number;
}
```

## Utility Functions

### getCollector()

Get the internal MetricCollector instance (advanced use).

```typescript
function getCollector(): MetricCollector | null
```

### getHydrationTracker()

Get the internal HydrationTracker instance (advanced use).

```typescript
function getHydrationTracker(): HydrationTracker | null
```

### getComponentTracker()

Get the internal ComponentTracker instance (advanced use).

```typescript
function getComponentTracker(): ComponentTracker | null
```

### getNavigationTracker()

Get the internal NavigationTracker instance (advanced use).

```typescript
function getNavigationTracker(): NavigationTracker | null
```

## Event Types

### Event Type Values

- `'hydration'` - Hydration timing events
- `'render'` - Component render events
- `'navigation'` - Route transition events
- `'page_timing'` - Page-level performance events

## Best Practices

### 1. Initialize Early

```typescript
// ‚úÖ Good - Initialize in app entry point
initHydrateBeer({ projectKey: 'my-app' });

// ‚ùå Bad - Don't initialize in components
function MyComponent() {
  useEffect(() => {
    initHydrateBeer({ projectKey: 'my-app' }); // Wrong!
  }, []);
}
```

### 2. Profile Selectively

```typescript
// ‚úÖ Good - Profile important components
const ProfiledHeader = withHydrateBeer(Header);

// ‚ùå Bad - Don't profile every tiny component
const ProfiledDiv = withHydrateBeer(() => <div />); // Overkill
```

### 3. Use Environment Variables

```typescript
// ‚úÖ Good - Use env vars
initHydrateBeer({
  projectKey: process.env.NEXT_PUBLIC_HYDRATE_BEER_KEY!,
});

// ‚ùå Bad - Don't hardcode keys
initHydrateBeer({
  projectKey: 'my-secret-key-12345', // Don't do this!
});
```

## Next Steps

- [Examples](/docs/examples) - Real-world usage examples
- [Tinybird Setup](/docs/tinybird) - Configure analytics backend
- [Troubleshooting](/docs/troubleshooting) - Common issues and solutions
